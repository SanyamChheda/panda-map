<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ishyam: The Origin Story ❤️</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            font-family: 'Segoe UI', sans-serif;
            touch-action: none; 
        }

        .stack-container {
            position: relative;
            width: 100%;
            height: 100%; 
            display: flex;
            justify-content: center;
            align-items: center;
            /* Increased perspective for a deeper 3D look */
            perspective: 2000px; 
            cursor: pointer;
        }

        .card {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #000;
            
            /* Hinge from the left */
            transform-origin: left center; 
            
            /* UPGRADED ANIMATION: 
               This 'cubic-bezier' curve mimics real paper physics.
               It starts slow, moves fast, then settles gently. 
            */
            transition: transform 0.9s cubic-bezier(0.645, 0.045, 0.355, 1), 
                        filter 0.5s ease;
            
            backface-visibility: hidden; 
            
            /* Initial state: bright and crisp */
            filter: brightness(1); 
        }

        .card img {
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            object-fit: contain; 
            
            /* A subtle shadow that stays on the image */
            box-shadow: 0 0 30px rgba(0,0,0,0.8);
            pointer-events: none; 
        }

        /* FLIPPED STATE */
        .card.flipped {
            /* Flip further (-160deg) so it really clears the view */
            transform: rotateY(-160deg); 
            
            /* Darken the page as it flips away to simulate shadow */
            filter: brightness(0.2); 
            
            /* We don't change opacity instantly anymore, 
               we let it disappear via backface-visibility naturally */
        }

        /* Controls */
        .controls {
            position: absolute;
            bottom: 30px;
            z-index: 1000;
            display: flex;
            gap: 40px;
            pointer-events: auto; 
        }

        button {
            padding: 12px 30px;
            font-size: 1rem;
            cursor: pointer;
            background-color: rgba(233, 30, 99, 0.9); 
            color: white;
            border: none;
            border-radius: 50px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.6);
            transition: transform 0.1s;
        }

        button:active {
            transform: scale(0.95);
        }
        
        button:disabled {
            opacity: 0.3;
            cursor: default;
            background-color: #555;
        }

    </style>
</head>
<body>

    <div class="stack-container" id="stack">
        </div>

    <div class="controls">
        <button id="btnPrev">Prev</button>
        <button id="btnNext">Next</button>
    </div>

    <script>
        const totalImages = 23; 
        const stackContainer = document.getElementById('stack');
        let currentIndex = 1; 

        // 1. Build the Stack
        for (let i = 1; i <= totalImages; i++) {
            const card = document.createElement('div');
            card.className = 'card';
            card.id = `card-${i}`;
            card.style.zIndex = totalImages - i + 1; 
            
            const img = document.createElement('img');
            img.src = `${i}.png`; 
            img.alt = `Page ${i}`;
            
            card.appendChild(img);
            stackContainer.appendChild(card);
        }

        // 2. Navigation Logic
        const btnNext = document.getElementById('btnNext');
        const btnPrev = document.getElementById('btnPrev');

        function goNext() {
            if (currentIndex <= totalImages) {
                const currentCard = document.getElementById(`card-${currentIndex}`);
                if (currentCard) {
                    currentCard.classList.add('flipped');
                    currentIndex++;
                    updateButtons();
                }
            }
        }

        function goPrev() {
            if (currentIndex > 1) {
                currentIndex--;
                const prevCard = document.getElementById(`card-${currentIndex}`);
                if (prevCard) {
                    prevCard.classList.remove('flipped');
                    updateButtons();
                }
            }
        }

        function updateButtons() {
            btnPrev.disabled = currentIndex === 1;
            btnNext.disabled = currentIndex > totalImages;
        }

        updateButtons();
        btnNext.addEventListener('click', (e) => { e.stopPropagation(); goNext(); });
        btnPrev.addEventListener('click', (e) => { e.stopPropagation(); goPrev(); });

        // 3. Swipe & Touch Logic
        let touchStartX = 0;
        let touchEndX = 0;

        stackContainer.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        }, false);

        stackContainer.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            handleGesture();
        }, false);

        // Mouse events for desktop swiping
        stackContainer.addEventListener('mousedown', (e) => {
            touchStartX = e.screenX;
        });

        stackContainer.addEventListener('mouseup', (e) => {
            touchEndX = e.screenX;
            handleGesture();
        });

        function handleGesture() {
            const threshold = 50; 
            
            // Calculate distance
            const distance = touchEndX - touchStartX;

            if (distance < -threshold) {
                // Swiped Left -> Go Next
                goNext();
            } else if (distance > threshold) {
                // Swiped Right -> Go Prev
                goPrev();
            } else {
                // Tap detection (for lazy clicking)
                const screenWidth = window.innerWidth;
                // If it's a small tap (not a drag)
                if (Math.abs(distance) < 10) {
                    if (touchStartX > screenWidth / 2) {
                        goNext();
                    } else {
                        goPrev();
                    }
                }
            }
        }

        // Keyboard Support
        document.addEventListener('keydown', (e) => {
            if (e.key === "ArrowRight" || e.key === " " || e.key === "Enter") goNext();
            if (e.key === "ArrowLeft") goPrev();
        });

    </script>
</body>
</html>